@use "../helpers" as *;

/* ===== GRID: 3 → 2 → 1, адаптивные зазоры ===== */
.services__grid {
  --grid-gap: #{clamp(rem(16), 3vw, rem(24))};

  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--grid-gap);

  @include tablet { grid-template-columns: repeat(2, 1fr); }
  @include mobile { grid-template-columns: 1fr; }
}

/* =========================
   КАРТОЧКА УСЛУГИ
   ========================= */
.service-card {
  /* настраиваемые переменные визуала */
  --radius: #{rem(18)};
  --shadow-rest: 0 0 #{rem(1)} rgba(0,0,0,.02);
  --shadow-hover: 0 #{rem(16)} #{rem(40)} rgba(0,0,0,.12);
  --action-space: #{rem(64)}; /* высота кнопки + зазор под текст */

  position: relative;
  border-radius: var(--radius);
  overflow: hidden;
  background: var(--color-white-secondary);
  box-shadow: var(--shadow-rest);
  transition:
          transform var(--transition-duration) ease,
          box-shadow var(--transition-duration) ease,
          background-color var(--transition-duration) ease;

  /* только на устройствах с hover */
  @include hover {
    transform: translateY(rem(-2));
    box-shadow: var(--shadow-hover);
  }

  @include mobile-s { --action-space: #{rem(56)}; }
}

/* ===== MEDIA: 16:10, зум лишь на hover-девайсах ===== */
.service-card__media {
  aspect-ratio: 16 / 10;
  overflow: hidden;

  img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transform: scale(1);
    transition: transform var(--transition-duration) ease;
  }

  .service-card {
    @include hover { & .service-card__media img { transform: scale(1.04); } }
  }
}

/* ===== Текст внизу поверх фото; резерв под кнопку ===== */
.service-card__body {
  position: absolute;
  z-index: 2;
  inset: auto rem(24) calc(var(--action-space) + #{rem(24)}) rem(24);

  @include mobile { inset: auto rem(16) calc(var(--action-space) + #{rem(16)}) rem(16); }
}

.service-card__title {
  @include fluid-text(28, 18);
  font-family: var(--font-family-accent);
  font-weight: 600;
  line-height: 1.2;
  color: #fff;
  text-shadow: 0 1px 2px rgba(0,0,0,.35);
  margin-right: 30%; /* чтобы длинный заголовок не упирался в кнопку */
}

/* ===== Затемняющий градиент снизу для читаемости ===== */
.service-card::after {
  content: '';
  position: absolute;
  inset: auto 0 0 0;
  height: 60%;
  background: linear-gradient(180deg,
          rgba(0,0,0,0) 0%,
          rgba(0,0,0,.25) 38%,
          rgba(0,0,0,.46) 100%);
  z-index: 1;

}

/* =========================
   ACTION: кнопка "Подробнее"
   ========================= */
.service-card__action {
  position: absolute;
  inset: auto rem(24) rem(24) rem(24);
  display: inline-flex;
  z-index: 3;

  @include hide;               /* на десктопах скрыта до наведения */
  translate: 0 rem(10);

  transition:
          opacity var(--transition-duration) ease,
          visibility var(--transition-duration) ease,
          translate var(--transition-duration) ease;


  @include mobile { inset: auto rem(16) rem(16) rem(16); }
}

/* Показ кнопки: hover/active только на десктопах */
.service-card {
  @include hover {
    & .service-card__action {
      @include show;
      translate: 0 0;
    }
  }
}

/* Доступность: по фокусу внутри карточки */
.service-card:focus-within .service-card__action {
  @include show;
  translate: 0 0;
}

/* Мобильный UX: всегда показываем кнопку, отключаем hover-эффекты */
@include mobile {
  .service-card__action { @include show; translate: 0 0; }
  .service-card { transform: none !important; box-shadow: var(--shadow-rest) !important; }
  .service-card__media img { transform: none !important; }
}

/* Prefers-reduced-motion — без лишней анимации */
@media (prefers-reduced-motion: reduce) {
  .service-card,
  .service-card__media img,
  .service-card__action {
    transition: none !important;
    transform: none !important;
  }
}
