[1mdiff --git a/scripts/ContactForm.js b/scripts/ContactForm.js[m
[1mindex 8c65cd5..9cc3669 100644[m
[1m--- a/scripts/ContactForm.js[m
[1m+++ b/scripts/ContactForm.js[m
[36m@@ -1,4 +1,7 @@[m
[31m-// Lightweight contact form controller (no deps)[m
[32m+[m[32m// ContactForm.js ‚Äî —Å—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è: –µ—Å–ª–∏ –≤–≤–µ–¥—ë–Ω email, —Ç–µ–ª–µ—Ñ–æ–Ω –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –∏ –ø–æ–ª–Ω—ã–π.[m
[32m+[m[32m// –ú–∞—Å–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –†–§ +7 (XXX) XXX-XX-XX —Å –∞–¥–µ–∫–≤–∞—Ç–Ω—ã–º backspace –∏ caret-–ø–æ–∑–∏—Ü–∏–µ–π.[m
[32m+[m[32m// –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω–µ—Ç.[m
[32m+[m
 export default class ContactForm {[m
     constructor(selector = '.feedback-form') {[m
         this.form = document.querySelector(selector);[m
[36m@@ -13,11 +16,10 @@[m [mexport default class ContactForm {[m
             this.ui.status.className = 'feedback-form__status';[m
             this.ui.status.setAttribute('role', 'status');[m
             this.ui.status.setAttribute('aria-live', 'polite');[m
[31m-            const actions = this.form.querySelector('.feedback-form__actions');[m
[31m-            (actions || this.form).appendChild(this.ui.status);[m
[32m+[m[32m            (this.form.querySelector('.feedback-form__actions') || this.form)[m
[32m+[m[32m                .appendChild(this.ui.status);[m
         }[m
 [m
[31m-[m
         this.inputs = {[m
             name: this.form.elements.name,[m
             phone: this.form.elements.phone,[m
[36m@@ -25,94 +27,227 @@[m [mexport default class ContactForm {[m
             topic: this.form.elements.topic,[m
             message: this.form.elements.message,[m
             agree: this.form.elements.agree,[m
[31m-            honeypot: this.form.elements.company, // hidden anti-bot[m
[32m+[m[32m            honeypot: this.form.elements.company, // –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Ä–∞–∑–º–µ—Ç–∫–µ, –æ–∫[m
         };[m
 [m
[31m-        // bind[m
[32m+[m[32m        // Bind[m
         this.form.addEventListener('submit', (e) => this.onSubmit(e));[m
[31m-        // live validation hints[m
[31m-        this.form.addEventListener('input', (e) => this.onInput(e));[m
[31m-        // light phone mask (RU-ish)[m
[32m+[m[32m        this.form.addEventListener('input', (e) => this.onInput(e), { passive: true });[m
[32m+[m[32m        this.form.addEventListener('blur', (e) => this.onBlur(e), true);[m
[32m+[m
[32m+[m[32m        // –¢–µ–ª–µ—Ñ–æ–Ω: –º–∞—Å–∫–∞ —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∫–∞—Ä–µ—Ç–∫–æ–π –∏ backspace[m
         if (this.inputs.phone) {[m
[31m-            this.inputs.phone.addEventListener('input', () => this.maskPhone());[m
[32m+[m[32m            this.inputs.phone.addEventListener('keydown', (e) => this.onPhoneKeydown(e));[m
[32m+[m[32m            this.inputs.phone.addEventListener('input', () => this.onPhoneInput());[m
             this.inputs.phone.addEventListener('blur', () => this.cleanPhoneIfEmpty());[m
         }[m
     }[m
 [m
[31m-    onInput(e) {[m
[31m-        // clear error for that field[m
[31m-        const input = e.target.closest('input,textarea');[m
[31m-        if (!input) return;[m
[31m-        this.setFieldError(input, '');[m
[31m-        // cross-field rule: one of (phone,email)[m
[31m-        if (input.name === 'phone' || input.name === 'email') {[m
[31m-            this.setFieldError(this.inputs.phone, '');[m
[31m-            this.setFieldError(this.inputs.email, '');[m
[31m-        }[m
[31m-    }[m
[31m-[m
[32m+[m[32m    // =========================[m
[32m+[m[32m    // –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã[m
[32m+[m[32m    // =========================[m
     setStatus(text, type = 'info') {[m
         if (!this.ui.status) return;[m
[31m-        this.ui.status.textContent = text;[m
[32m+[m[32m        this.ui.status.textContent = text || '';[m
         this.ui.status.dataset.type = type;[m
     }[m
 [m
     disableForm(disabled = true) {[m
[31m-        this.form.querySelectorAll('input, textarea, button').forEach(el => { el.disabled = disabled; });[m
[32m+[m[32m        this.form.querySelectorAll('input, textarea, button')[m
[32m+[m[32m            .forEach((el) => { el.disabled = disabled; });[m
     }[m
 [m
     setFieldError(input, message) {[m
[31m-        const wrap = input.closest('.field, .check');[m
[31m-        if (!wrap) return;[m
[31m-        const err = wrap.querySelector('.field__error');[m
[32m+[m[32m        const wrap = input?.closest('.field, .check');[m
[32m+[m[32m        const err = wrap?.querySelector('.field__error');[m
         if (err) err.textContent = message || '';[m
[31m-        input.classList.toggle('is-invalid', !!message);[m
[32m+[m[32m        if (input) {[m
[32m+[m[32m            input.classList.toggle('is-invalid', !!message);[m
[32m+[m[32m            input.setAttribute('aria-invalid', message ? 'true' : 'false');[m
[32m+[m[32m        }[m
     }[m
 [m
[31m-    validate() {[m
[31m-        let ok = true;[m
[32m+[m[32m    clearAllErrors() {[m
[32m+[m[32m        this.form.querySelectorAll('.field__error').forEach((n) => (n.textContent = ''));[m
[32m+[m[32m        this.form.querySelectorAll('.is-invalid').forEach((el) => el.classList.remove('is-invalid'));[m
[32m+[m[32m        this.form.querySelectorAll('[aria-invalid="true"]').forEach((el) => el.setAttribute('aria-invalid', 'false'));[m
[32m+[m[32m    }[m
 [m
[31m-        // required[m
[31m-        ['name', 'message'].forEach(name => {[m
[31m-            const el = this.inputs[name];[m
[31m-            if (!el?.value.trim()) {[m
[31m-                this.setFieldError(el, '–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ');[m
[31m-                ok = false;[m
[32m+[m[32m    // =========================[m
[32m+[m[32m    // –¢–µ–ª–µ—Ñ–æ–Ω: –º–∞—Å–∫–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞[m
[32m+[m[32m    // =========================[m
[32m+[m[32m    getPhoneDigits() {[m
[32m+[m[32m        return (this.inputs.phone?.value || '').replace(/\D+/g, '');[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    isPhoneCompleteRU() {[m
[32m+[m[32m        // –¢—Ä–µ–±—É–µ–º —Ä–æ–≤–Ω–æ 11 —Ü–∏—Ñ—Ä. –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –Ω–∞ 7 –≤ –Ω–∞—á–∞–ª–µ.[m
[32m+[m[32m        let d = this.getPhoneDigits();[m
[32m+[m[32m        if (!d) return false;[m
[32m+[m[32m        if (d.startsWith('8')) d = '7' + d.slice(1);[m
[32m+[m[32m        if (!d.startsWith('7')) return false;[m
[32m+[m[32m        return d.length === 11;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    formatPhoneFromDigits(digits) {[m
[32m+[m[32m        // –ü—Ä–∏–≤–æ–¥–∏–º –∫ –≤–∏–¥—É +7 (XXX) XXX-XX-XX[m
[32m+[m[32m        let d = digits.replace(/\D+/g, '');[m
[32m+[m[32m        if (!d) return '';[m
[32m+[m
[32m+[m[32m        if (d.startsWith('8')) d = '7' + d.slice(1);[m
[32m+[m[32m        if (!d.startsWith('7')) d = '7' + d;[m
[32m+[m[32m        d = d.slice(0, 11);[m
[32m+[m
[32m+[m[32m        let out = '+7';[m
[32m+[m[32m        if (d.length > 1) out += ' (' + d.slice(1, 4);[m
[32m+[m[32m        if (d.length >= 4) out += ') ' + d.slice(4, 7);[m
[32m+[m[32m        if (d.length >= 7) out += '-' + d.slice(7, 9);[m
[32m+[m[32m        if (d.length >= 9) out += '-' + d.slice(9, 11);[m
[32m+[m
[32m+[m[32m        return out;[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    onPhoneKeydown(e) {[m
[32m+[m[32m        // –†–∞–∑—Ä–µ—à–∞–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é, delete/home/end/—Å—Ç—Ä–µ–ª–∫–∏, tab[m
[32m+[m[32m        const k = e.key;[m
[32m+[m[32m        if ([m
[32m+[m[32m            k === 'Tab' || k === 'Enter' ||[m
[32m+[m[32m            k === 'ArrowLeft' || k === 'ArrowRight' || k === 'Home' || k === 'End' ||[m
[32m+[m[32m            k === 'Delete'[m
[32m+[m[32m        ) return;[m
[32m+[m
[32m+[m[32m        // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤–≤–æ–¥–∞: —Ü–∏—Ñ—Ä—ã, +, (, ), -, –ø—Ä–æ–±–µ–ª ‚Äî –æ—Å—Ç–∞–ª—å–Ω–æ–µ –±–ª–æ–∫–∏—Ä—É–µ–º[m
[32m+[m[32m        const allowed = /[\d\+\-\s\(\)]/;[m
[32m+[m[32m        if (k.length === 1 && !allowed.test(k)) {[m
[32m+[m[32m            e.preventDefault();[m
[32m+[m[32m            return;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        // Backspace: –ø–µ—Ä–µ–ø—Ä—ã–≥–∏–≤–∞–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏[m
[32m+[m[32m        if (k === 'Backspace') {[m
[32m+[m[32m            const input = this.inputs.phone;[m
[32m+[m[32m            const pos = input.selectionStart;[m
[32m+[m[32m            const val = input.value;[m
[32m+[m
[32m+[m[32m            // –ï—Å–ª–∏ —Å–ª–µ–≤–∞ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å ‚Äî —Å–¥–≤–∏–≥–∞–µ–º –∫–∞—Ä–µ—Ç–∫—É –µ—â—ë –Ω–∞ 1 –≤–ª–µ–≤–æ, —á—Ç–æ–±—ã —É–¥–∞–ª—è—Ç—å ¬´–ø–∞—á–∫–æ–π¬ª[m
[32m+[m[32m            const sep = /[()\-\s]/;[m
[32m+[m[32m            if (pos && sep.test(val[pos - 1])) {[m
[32m+[m[32m                e.preventDefault();[m
[32m+[m[32m                const nextPos = pos - 1;[m
[32m+[m[32m                input.setSelectionRange(nextPos, nextPos);[m
[32m+[m[32m                // —ç–º—É–ª–∏—Ä—É–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—ã–π backspace –ø–æ —Ü–∏—Ñ—Ä–µ[m
[32m+[m[32m                const ev = new KeyboardEvent('keydown', { key: 'Backspace', bubbles: true });[m
[32m+[m[32m                input.dispatchEvent(ev);[m
             }[m
[31m-        });[m
[32m+[m[32m        }[m
[32m+[m[32m    }[m
 [m
[31m-        // at least one of phone/email[m
[31m-        const phoneVal = (this.inputs.phone?.value || '').trim();[m
[31m-        const emailVal = (this.inputs.email?.value || '').trim();[m
[32m+[m[32m    onPhoneInput() {[m
[32m+[m[32m        const input = this.inputs.phone;[m
[32m+[m[32m        const start = input.selectionStart || 0;[m
 [m
[31m-        if (!phoneVal && !emailVal) {[m
[31m-            this.setFieldError(this.inputs.phone, '–£–∫–∞–∂–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω –∏–ª–∏ email');[m
[31m-            this.setFieldError(this.inputs.email, '–£–∫–∞–∂–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω –∏–ª–∏ email');[m
[31m-            ok = false;[m
[32m+[m[32m        // –¢–µ–∫—É—â–∏–µ —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã, —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º[m
[32m+[m[32m        const digits = this.getPhoneDigits();[m
[32m+[m[32m        const before = input.value.slice(0, start);[m
[32m+[m[32m        const beforeDigits = before.replace(/\D+/g, '').length;[m
[32m+[m
[32m+[m[32m        const masked = this.formatPhoneFromDigits(digits);[m
[32m+[m[32m        input.value = masked;[m
[32m+[m
[32m+[m[32m        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–∞—Ä–µ—Ç–∫—É: —Å—á–∏—Ç–∞–µ–º, –≥–¥–µ –æ–∫–∞–∑–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –º–∞—Å–∫–∏[m
[32m+[m[32m        let i = 0;[m
[32m+[m[32m        let counted = 0;[m
[32m+[m[32m        while (i < input.value.length && counted < beforeDigits) {[m
[32m+[m[32m            if (/\d/.test(input.value[i])) counted++;[m
[32m+[m[32m            i++;[m
[32m+[m[32m        }[m
[32m+[m[32m        input.setSelectionRange(i, i);[m
[32m+[m
[32m+[m[32m        // –ñ–∏–≤—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ —Ñ–æ—Ä–º–∞—Ç—É[m
[32m+[m[32m        if (digits.length && digits.length < 11) {[m
[32m+[m[32m            this.setFieldError(input, '–ù—É–∂–Ω–æ 11 —Ü–∏—Ñ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞');[m
[32m+[m[32m        } else {[m
[32m+[m[32m            this.setFieldError(input, '');[m
         }[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    cleanPhoneIfEmpty() {[m
[32m+[m[32m        const input = this.inputs.phone;[m
[32m+[m[32m        if (!input) return;[m
[32m+[m[32m        // –ï—Å–ª–∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ—Ç —Ü–∏—Ñ—Ä ‚Äî –æ—á–∏—â–∞–µ–º –ø–æ–ª–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é[m
[32m+[m[32m        if (!this.getPhoneDigits()) input.value = '';[m
[32m+[m[32m    }[m
[32m+[m
[32m+[m[32m    // =========================[m
[32m+[m[32m    // –í–∞–ª–∏–¥–∞—Ü–∏—è[m
[32m+[m[32m    // =========================[m
[32m+[m[32m    validate() {[m
[32m+[m[32m        let ok = true;[m
[32m+[m
[32m+[m[32m        const name = this.inputs.name;[m
[32m+[m[32m        const message = this.inputs.message;[m
[32m+[m[32m        const phone = this.inputs.phone;[m
[32m+[m[32m        const email = this.inputs.email;[m
[32m+[m[32m        const agree = this.inputs.agree;[m
 [m
[31m-        // formats[m
[31m-        if (phoneVal && !/^[\d+\-\s()]{10,}$/.test(phoneVal)) {[m
[31m-            this.setFieldError(this.inputs.phone, '–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω');[m
[32m+[m[32m        const nameVal = name?.value.trim() || '';[m
[32m+[m[32m        const msgVal = message?.value.trim() || '';[m
[32m+[m[32m        const emailVal = email?.value.trim() || '';[m
[32m+[m
[32m+[m[32m        // –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ[m
[32m+[m[32m        if (!nameVal) {[m
[32m+[m[32m            this.setFieldError(name, '–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ');[m
             ok = false;[m
         }[m
[31m-        if (emailVal && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailVal)) {[m
[31m-            this.setFieldError(this.inputs.email, '–ù–µ–≤–µ—Ä–Ω—ã–π email');[m
[32m+[m[32m        if (!msgVal) {[m
[32m+[m[32m            this.setFieldError(message, '–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ');[m
             ok = false;[m
         }[m
 [m
[31m-        // agree[m
[31m-        if (this.inputs.agree && !this.inputs.agree.checked) {[m
[31m-            this.setFieldError(this.inputs.agree, '–ù—É–∂–Ω–æ —Å–æ–≥–ª–∞—Å–∏–µ');[m
[32m+[m[32m        // Email —Ñ–æ—Ä–º–∞—Ç (–µ—Å–ª–∏ –≤–≤–µ–¥—ë–Ω)[m
[32m+[m[32m        let emailOk = false;[m
[32m+[m[32m        if (emailVal) {[m
[32m+[m[32m            emailOk = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailVal);[m
[32m+[m[32m            if (!emailOk) {[m
[32m+[m[32m                this.setFieldError(email, '–ù–µ–≤–µ—Ä–Ω—ã–π email');[m
[32m+[m[32m                ok = false;[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        // –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ:[m
[32m+[m[32m        // 1) –ï—Å–ª–∏ email –≤–≤–µ–¥—ë–Ω (–∏ –≤–∞–ª–∏–¥–µ–Ω) ‚Üí —Ç–µ–ª–µ—Ñ–æ–Ω –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –∏ –î–û–õ–ñ–ï–ù –±—ã—Ç—å –ø–æ–ª–Ω—ã–º (11 —Ü–∏—Ñ—Ä –†–§).[m
[32m+[m[32m        // 2) –ï—Å–ª–∏ email –Ω–µ –≤–≤–µ–¥—ë–Ω ‚Üí —Ç–µ–ª–µ—Ñ–æ–Ω –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –∏ –ø–æ–ª–Ω—ã–π.[m
[32m+[m[32m        const phoneComplete = this.isPhoneCompleteRU();[m
[32m+[m
[32m+[m[32m        if (emailVal) {[m
[32m+[m[32m            if (!phoneComplete) {[m
[32m+[m[32m                this.setFieldError(phone, '–ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω email ‚Äî –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é');[m
[32m+[m[32m                ok = false;[m
[32m+[m[32m            }[m
[32m+[m[32m        } else {[m
[32m+[m[32m            if (!phoneComplete) {[m
[32m+[m[32m                this.setFieldError(phone, '–£–∫–∞–∂–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω (+7 –∏ 11 —Ü–∏—Ñ—Ä)');[m
[32m+[m[32m                ok = false;[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        // –°–æ–≥–ª–∞—Å–∏–µ[m
[32m+[m[32m        if (agree && !agree.checked) {[m
[32m+[m[32m            this.setFieldError(agree, '–ù—É–∂–Ω–æ —Å–æ–≥–ª–∞—Å–∏–µ');[m
             ok = false;[m
         }[m
 [m
[31m-        // honeypot[m
[31m-        if (this.inputs.honeypot?.value) ok = false;[m
[32m+[m[32m        // Honeypot (–µ—Å–ª–∏ –µ—Å—Ç—å –≤ —Ñ–æ—Ä–º–µ –∏ –≤–¥—Ä—É–≥ –∑–∞–ø–æ–ª–Ω–µ–Ω)[m
[32m+[m[32m        if (this.inputs.honeypot?.value) {[m
[32m+[m[32m            ok = false;[m
[32m+[m[32m        }[m
 [m
         return ok;[m
     }[m
 [m
[32m+[m[32m    // =========================[m
[32m+[m[32m    // –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞[m
[32m+[m[32m    // =========================[m
     collectPayload() {[m
         const data = {[m
             name: this.inputs.name?.value.trim() || null,[m
[36m@@ -121,6 +256,7 @@[m [mexport default class ContactForm {[m
             topic: this.inputs.topic?.value.trim() || null,[m
             message: this.inputs.message?.value.trim() || null,[m
             agree: !!this.inputs.agree?.checked,[m
[32m+[m[32m            company: this.inputs.honeypot?.value || '', // honeypot –Ω–∞ –±—ç–∫–µ[m
             source: 'hyprotec-site',[m
             ts: new Date().toISOString(),[m
         };[m
[36m@@ -129,8 +265,7 @@[m [mexport default class ContactForm {[m
 [m
     async onSubmit(e) {[m
         e.preventDefault();[m
[31m-        // clear previous errors[m
[31m-        this.form.querySelectorAll('.field__error').forEach(n => (n.textContent = ''));[m
[32m+[m[32m        this.clearAllErrors();[m
 [m
         if (!this.validate()) return;[m
 [m
[36m@@ -139,25 +274,32 @@[m [mexport default class ContactForm {[m
 [m
         const payload = this.collectPayload();[m
 [m
[31m-        // abort after 12s[m
[32m+[m[32m        // Abort —á–µ—Ä–µ–∑ 12—Å[m
         const ctrl = new AbortController();[m
         const timeout = setTimeout(() => ctrl.abort(), 12000);[m
 [m
         try {[m
             const res = await fetch('/api/contact', {[m
                 method: 'POST',[m
[31m-                headers: {'Content-Type': 'application/json'},[m
[32m+[m[32m                headers: { 'Content-Type': 'application/json' },[m
                 body: JSON.stringify(payload),[m
                 signal: ctrl.signal,[m
             });[m
 [m
             clearTimeout(timeout);[m
 [m
[31m-            if (!res.ok) throw new Error(`HTTP ${res.status}`);[m
[32m+[m[32m            if (!res.ok) {[m
[32m+[m[32m                // –ø–æ–ø—Ä–æ–±—É–µ–º –ø—Ä–æ—á–∏—Ç–∞—Ç—å –æ—Ç–≤–µ—Ç –±—ç–∫–∞, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—Å—Ç[m
[32m+[m[32m                let msg = `HTTP ${res.status}`;[m
[32m+[m[32m                try {[m
[32m+[m[32m                    const j = await res.json();[m
[32m+[m[32m                    if (j?.message) msg = j.message;[m
[32m+[m[32m                } catch {}[m
[32m+[m[32m                throw new Error(msg);[m
[32m+[m[32m            }[m
 [m
             this.setStatus('–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞. –°–ø–∞—Å–∏–±–æ!', 'success');[m
             this.form.reset();[m
[31m-            // return focus to first field for accessibility[m
             this.inputs.name?.focus();[m
         } catch (err) {[m
             this.setStatus('–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.', 'error');[m
[36m@@ -167,27 +309,37 @@[m [mexport default class ContactForm {[m
         }[m
     }[m
 [m
[31m-    // ---------- tiny phone helpers ----------[m
[31m-    maskPhone() {[m
[31m-        // digits only, try to format like +7 (XXX) XXX-XX-XX ‚Äî –±–µ–∑ –Ω–∞–≤—è–∑—á–∏–≤–æ—Å—Ç–∏[m
[31m-        let d = this.inputs.phone.value.replace(/\D+/g, '');[m
[31m-        if (!d) return;[m
[31m-        if (d.startsWith('8')) d = '7' + d.slice(1);[m
[31m-        if (!d.startsWith('7')) d = '7' + d;[m
[31m-        d = d.slice(0, 11);[m
[32m+[m[32m    // =========================[m
[32m+[m[32m    // UX-–º–µ–ª–æ—á–∏[m
[32m+[m[32m    // =========================[m
[32m+[m[32m    onInput(e) {[m
[32m+[m[32m        const input = e.target.closest('input,textarea');[m
[32m+[m[32m        if (!input) return;[m
 [m
[31m-        let out = '+7';[m
[31m-        if (d.length > 1) out += ' (' + d.slice(1, 4);[m
[31m-        if (d.length >= 4) out += ') ' + d.slice(4, 7);[m
[31m-        if (d.length >= 7) out += '-' + d.slice(7, 9);[m
[31m-        if (d.length >= 9) out += '-' + d.slice(9, 11);[m
[32m+[m[32m        // –°–Ω–∏–º–∞–µ–º –æ—à–∏–±–∫—É —Å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—è[m
[32m+[m[32m        this.setFieldError(input, '');[m
 [m
[31m-        this.inputs.phone.value = out;[m
[32m+[m[32m        // –°–∫—Ä–µ—Å—Ç–Ω—ã–µ –ø–æ–ª—è: –µ—Å–ª–∏ –º–µ–Ω—è–µ–º phone/email ‚Äî —Å–Ω–∏–º–∞–µ–º –æ—à–∏–±–∫–∏ –Ω–∞ –æ–±–æ–∏—Ö[m
[32m+[m[32m        if (input.name === 'phone' || input.name === 'email') {[m
[32m+[m[32m            this.setFieldError(this.inputs.phone, '');[m
[32m+[m[32m            this.setFieldError(this.inputs.email, '');[m
[32m+[m[32m        }[m
     }[m
 [m
[31m-    cleanPhoneIfEmpty() {[m
[31m-        if (this.inputs.phone.value.replace(/\D+/g, '').length <= 1) {[m
[31m-            this.inputs.phone.value = '';[m
[32m+[m[32m    onBlur(e) {[m
[32m+[m[32m        const input = e.target.closest('input,textarea');[m
[32m+[m[32m        if (!input) return;[m
[32m+[m
[32m+[m[32m        // –õ–æ–∫–∞–ª—å–Ω–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –Ω–∞ blur[m
[32m+[m[32m        if (input === this.inputs.email && input.value.trim()) {[m
[32m+[m[32m            if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(input.value.trim())) {[m
[32m+[m[32m                this.setFieldError(input, '–ù–µ–≤–µ—Ä–Ω—ã–π email');[m
[32m+[m[32m            }[m
[32m+[m[32m        }[m
[32m+[m[32m        if (input === this.inputs.phone && this.getPhoneDigits()) {[m
[32m+[m[32m            if (!this.isPhoneCompleteRU()) {[m
[32m+[m[32m                this.setFieldError(input, '–ù—É–∂–Ω–æ 11 —Ü–∏—Ñ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞');[m
[32m+[m[32m            }[m
         }[m
     }[m
 }[m
